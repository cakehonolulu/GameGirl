#include "include/cb_opcodes.h"

const struct m_sharp_lr35902_instr_cb m_gb_instr_cb[256] = {
	{NULL, NULL},							// 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{"BIT 7, H", m_bit_7_h},				// 0x7C
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},							// 0x7C
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL},                           // 0x00
	{NULL, NULL}                           	// 0x00
};

void m_cb_ext(uint8_t cb_instr)
{
	printf("CB Mode Instr!\n");

	printf("Current CB Opcode: 0x%x\n", cb_instr);

	((void (*)(void))m_gb_instr_cb[cb_instr].m_funct)();
}

/*
	BIT 7, H
	Opcode: 0x7C
	Number of Bytes: 2
	Number of Cycles: 2

	Copy the complement of the contents of bit 7 in register H
	to the Z flag of the program status word (PSW).
*/
void m_bit_7_h()
{
	if (!m_is_bit_set(m_regs.h, Z))
	{
		FLAG_SET(m_regs.flags, Z);
	} else {
		FLAG_UNSET(m_regs.flags, Z);
	}

	FLAG_UNSET(m_regs.flags, N);

	FLAG_SET(m_regs.flags, H);
#ifdef OPCODE_DEBUG
	printf("Flags: 0x%02x\n", m_regs.flags);
#endif
	m_regs.pc += 2;
}
